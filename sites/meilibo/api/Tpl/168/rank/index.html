<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <meta http-equiv="X-UA-Compatible"content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="__PUBLIC__/meilibo/images/favicon.ico" rel="shortcut icon">
  <title>排行榜</title>
 <link rel="stylesheet" type="text/css" href="__PUBLIC__/meilibo/css/common.css">
 <link rel="stylesheet" type="text/css" href="__PUBLIC__/meilibo/css/user.css">
  <link rel="stylesheet" type="text/css" href="__PUBLIC__/meilibo/css/inside.css">
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/jquery.md5.js"></script>
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/blocksit.min.js"></script>
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/common.js"></script>
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/wishing.js"></script>
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/logon-2.0.js"></script>
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/jquery.cookie.js"></script>
  <script type="text/javascript" src="__PUBLIC__/meilibo/js/usercenter.js"></script>
  <script>
    UAC.showUserInfo = function(data) {if(data.isLogin == "1"){window.location.reload();}}
  </script>
  <script type="text/javascript">
   $(function(){
      var datalist;
      var gsid;
      var num = 0;
      var more_s;
      function getcon_init(sid)
      {
        
        $.cookie("csid2015",sid,
        {
          path:"/",
        })
        
        var setmap1;
        setmap1 = $.cookie("setmap1");

        var order;
        order = $.cookie("order2015");
        var province = $.cookie("province");
        gsid = sid;

        $("#conlist").html("<br /><br /><br />加载中...")
        $(function()
        {
          $.get("__URL__/listbobo2",{sid:sid,setmap1:setmap1,order:order},function(data,t){
            $("#conlist").html(data);
            })
      });
      }
      function getcon(sid)
      {

        getcon_init(sid);
        //存cooike
        $.cookie("csid2015",sid,
        {
          path:"/",
        })
        
        var setmap1;
        setmap1 = $.cookie("setmap1");
        
        var order;
        order = $.cookie("order2015");
        
        var selectpro;

        selectpro = $.cookie("province");
        if(sid!=gsid)
        {
          num = 0;
          $("#conlist").html("");
        }
          gsid = sid;

          $(".hroom li").hover(function(){
           $(this).find(".opac").css({"height":"135px"});
         },function(){
           $(this).find(".opac").css({"height":"22px"});
         })  
          //$("#conlist").html("<br /><br /><br />加载中...")
          $(function()
          {
    
            $.get("__URL__/listbobo2",{sid:sid,num:num,order:order,setmap1:setmap1},function(data,t){
              //$("#conlist").html(data);
              datalist = data;
              })
        });
          
      }
      
      $(function(){
      //获取分类列表
          $(window).scroll(function(){
              // 当滚动到最底部以上50像素时， 加载新内容
            if ($(document).height() - $(this).scrollTop() - $(this).height()<50){
            }
          });
        //}
        
        //window resize
        var currentWidth = 1100;
        $(window).resize(function() {
          var winWidth = $(window).width();
          var conWidth;
          if(winWidth < 660) {
            conWidth = 440;
            col = 2
          } else if(winWidth < 880) {
            conWidth = 660;
            col = 3
          } else if(winWidth < 1100) {
            conWidth = 880;
            col = 4;
          } else {
            conWidth = 1100;
            col = 5;
          }
          
        });
      });
      
      function e_selectpro()
      {
        var t =  $(this).text();
        $.cookie("province",t,
        {
          path:"/",
        })
        num = 0;
        getcon_init($.cookie("csid2015"))

        getcon($.cookie("csid2015"));
      }
  })
  </script>
 </head>
 <body style="background:#FBFBFB;">
 <!--header-->
  <include file="Public:header" />
 <!--header-->
<!--content-->
<div class="wrap rank clearfix">
  <div class="rank-common-wrap star2">
    <img class="title" src="__PUBLIC__/meilibo/images/preside_banner.jpg">
    <div class="rank-common-header clearfix">
      <ul class="clearfix">
        <li title="presideDay"><a href="javascript:;">日</a></li>
        <li title="presideWeek"><a href="javascript:;">周</a></li>
        <li title="presideMonth"><a href="javascript:;">月</a></li>
        <li class="on" title="presideTotal"><a href="javascript:;">总</a></li>
      </ul>
    </div>
    <div class="rank-common-content">
      <ul class="list-day" id="presideDay">
      </ul>
      <ul class="list-week" id="presideWeek">
      </ul>
      <ul class="list-month" id="presideMonth">
      </ul>
      <ul class="list-total" id="presideTotal" style="display:block;">
      </ul>
    </div>
  </div>
  <div class="rank-common-wrap Regal">
    <img class="title" src="__PUBLIC__/meilibo/images/moods_banner.jpg">
    <div class="rank-common-header clearfix">
      <ul class="clearfix">
        <li title="popularityDay"><a href="javascript:;">日</a></li>
        <li title="popularityWeek"><a href="javascript:;">周</a></li>
        <li title="popularityMonth"><a href="javascript:;">月</a></li>
        <li class="on"  title="popularityTotal"><a href="javascript:;">总</a></li>
      </ul>
    </div>
    <div class="rank-common-content">
      <ul class="list-day" id="popularityDay">
      </ul>
      <ul class="list-week" id="popularityWeek">
      </ul>
      <ul class="list-month" id="popularityMonth">
      </ul>
      <ul class="list-total" id="popularityTotal" style="display:block;">
      </ul>
    </div>
  </div>
  <div class="rank-common-wrap charm">
    <img class="title" src="__PUBLIC__/meilibo/images/bill_banner.jpg">
    <div class="rank-common-header clearfix">
      <ul class="clearfix">
        <li title="wealthDay"><a href="javascript:;">日</a></li>
        <li title="wealthWeek"><a href="javascript:;">周</a></li>
        <li title="wealthMonth"><a href="javascript:;">月</a></li>
        <li class="on"  title="wealthTotal"><a href="javascript:;">总</a></li>
      </ul>
    </div>
    <div class="rank-common-content">
      <ul class="list-day" id="wealthDay">
      </ul>
      <ul class="list-week" id="wealthWeek">
      </ul>
      <ul class="list-month" id="wealthMonth">
      </ul>
      <ul class="list-total" id="wealthTotal" style="display:block;" >
      </ul>
    </div>
  </div>
  <div class="rank-common-wrap week-star-wrap">
    <div class="week-top">
      <img src="__PUBLIC__/meilibo/images/gift_banner.jpg">
      <div class="rankwenk fr clearfix">
        <span>本周</span> | <span class="on">上周</span>
      </div>
    </div>
    <div class="rank-common-content2 clearfix" id="giftThisWeek"  style="display: none;">
      <ul>
      </ul>
      <ul>
      </ul>
      <ul>
      </ul>
    </div>
    <div class="rank-common-content2 clearfix" id="giftLastWeek">
      <ul>
      </ul>
      <ul>
      </ul>
      <ul>
      </ul>
    </div>
  </div>
</div>
<!--content-->

<!--footer-->
 <include file="Public:footer" />
<!--footer-->
 <script type="text/javascript">
   $(function(){
    
    function rank(tab,list){
      $(tab).click(function(){
      $(this).addClass("on").siblings().removeClass("on");
      ajaxRequest($(this).attr('title'));
      var _index=$(this).index();
      $(list).eq(_index).fadeIn().siblings().hide();
    })
   }
    $(".week-star-wrap .rankwenk span").click(function(){
      $(this).addClass("on").siblings().removeClass("on");
      var _index=$(this).index();
      var action = _index == 0 ? 'giftThisWeek' : 'giftLastWeek';
      ajaxGiftRequest(action);
      $(".rank-common-content2").eq(_index).fadeIn().siblings(".rank-common-content2").hide();
    })
   rank(".star2 .rank-common-header li",".star2 .rank-common-content ul");
   rank(".Regal .rank-common-header li",".Regal .rank-common-content ul");
   rank(".charm .rank-common-header li",".charm .rank-common-content ul");

    $(".loginsTab span").click(function(){
      var _index=$(this).index();
      $(this).addClass("on").siblings().removeClass("on");
      $(".logins_box .box").eq(_index).removeClass("none").siblings(".box").addClass("none");
    })

    $(".login_close").click(function(){
      $(".dialoger").addClass("none");
      $(".logins_box").addClass("none");
    })

    $(".head_login .login_dd").click(function(){
      $(".dialoger").removeClass("none");
      $(".logins_box").removeClass("none");
    })
   })

  //presideDay Week Month Total
  function ajaxRequest(action)
  {
    var url = 'rank/'+action;
    $.ajax({
      url:url,
      success:function(data){
        var obj = eval('('+data+')');
        // console.log(obj);
        $("#"+action).children().remove();
        for(var index in obj) {
          if (index < 2) {
            addFrontThree(action,index, obj[index]);
            continue;
          }
          addAtherLeft(action,index,obj[index]);
        }
      }
    });
  }
  function ajaxGiftRequest(action)
  {
    var url = 'rank/'+action;
    $.ajax({
      url:url,
      success:function(data){
        var obj = eval('('+data+')');
        // console.log(obj);
        $("#"+action+">ul>li").remove();
        for(var index in obj) {
          addGiftItem(action,index, obj[index]);
        }
      }
    });
  }
  function addGiftItem(action, index,item)
  {
    var str = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
            +'<i><img src="'+item["giftinfo"]["path"]+'" width="22" height="22"></i>'
            +'<span class="tit">'+item["giftinfo"]["name"]+'('+item["giftcount"]+')</span>'
            +'<span class="uid text_hidden2">'+item["userinfo"]["nickname"]+'</span>'
            +'<b class="zlevel zlv'+item["emceelevel"][0]["levelid"]+'"></b></a></li>';
    index = parseInt(index / 10) ;
    $("#"+action).children().eq(index).append(str);
  }
  function addFrontThree(id,index,item)
  {
    var bg = index == 0 ? 'firstbg' : 'secondbg';
    if(id == "wealthTotal"){
        var str1 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
              +'<i class="'+bg+'"></i>'
              +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="zlevel zlv'+item["richlevel"][0]["levelid"]+'"></em></a></li>';
        var str2 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
            +'<i class="'+bg+'"></i>'
            +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="starLV car'+item["richlevel"][0]["levelid"]+'"></em></a></li>';     
      $(".star2 #"+id).append(str1);
      $(".Regal #"+id).append(str1);
      $(".charm #"+id).append(str2);
    }else{
        var str1 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
              +'<i class="'+bg+'"></i>'
              +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="zlevel zlv'+item["emceelevel"][0]["levelid"]+'"></em></a></li>';
        var str2 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
            +'<i class="'+bg+'"></i>'
            +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="starLV car'+item["emceelevel"][0]["levelid"]+'"></em></a></li>';     
      $(".star2 #"+id).append(str1);
      $(".Regal #"+id).append(str1);
      $(".charm #"+id).append(str2);
    }
  }
  function addAtherLeft(id, index, item)
  {
    index++;
    if(id == "wealthTotal"){
    var str1 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
            +'<i>'+index+'</i>'
            +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="zlevel zlv'+item["richlevel"][0]["levelid"]+'"></em></a></li>';
        var str2 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
            +'<i>'+index+'</i>'
            +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="starLV car'+item["richlevel"][0]["levelid"]+'"></em></a></li>';
      $(".star2 #"+id).append(str1);
      $(".Regal #"+id).append(str1);
      $(".charm #"+id).append(str2);
    }else{
    var str1 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
            +'<i>'+index+'</i>'
            +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="zlevel zlv'+item["emceelevel"][0]["levelid"]+'"></em></a></li>';
        var str2 = '<li><a href="/'+item["userinfo"]["curroomnum"]+'">'
            +'<i>'+index+'</i>'
            +'<img onerror="javascript:this.src='+'\'/style/avatar/0/0_big.jpg\''+'" src="/style/avatar/'+$.md5(item["userinfo"]["id"]).substring(0,3)+'/'+item["userinfo"]["id"]+'_middle.jpg" width="36" height="36" />'
            +'<span class="text_hidden2">'+item["userinfo"]["nickname"]+'('+item["userinfo"]["curroomnum"]+')</span>'
            +'<em class="starLV car'+item["emceelevel"][0]["levelid"]+'"></em></a></li>';
      $(".star2 #"+id).append(str1);
      $(".Regal #"+id).append(str1);
      $(".charm #"+id).append(str2);
    }
  }
  $(function(){
    ajaxRequest('presideTotal');
    ajaxRequest('popularityTotal');
    ajaxRequest('wealthTotal');
    ajaxGiftRequest('giftLastWeek');
  });
 </script>
 </body>
</html>
